import numpy as np
import os
import sys
import time

atom_energy_dict = {"Corannulene.xyz" : -61.06299,
"D-Galactose.xyz" : -53.05407,
"Zethrene.xyz" : -74.59302,
"C197.xyz" : -540.10079,
"Benzene.xyz" : -20.17765,
"Alpha-L-fucopyranose.xyz" : -48.25824,
"L-Proline.xyz" : -32.81500,
"Citric_acid.xyz" : -55.39726,
"1H-Indene.xyz" : -29.66074,
"Alpha-D-psicopyranose.xyz" : -53.10596,
"Triphenylene.xyz" : -56.86048,
"D-Glyceraldehyde.xyz" : -26.49473,
"D-Erythrulose.xyz" : -35.34829,
"L-Tartaric_acid.xyz" : -43.79707,
"L-Histidine.xyz" : -42.97593,
"3-Trigonal-pyramidal.xyz" : -5.59710,
"Alpha-L-arabinopyranose.xyz" : -44.25379,
"Beta-L-ribopyranose.xyz" : -44.25529,
"D-Psicose.xyz" : -53.05602,
"Phenol.xyz" : -25.03045,
"D-Xylulose.xyz" : -44.19863,
"C35.xyz" : -95.52210,
"D-Serine.xyz" : -30.89546,
"Beta-D-tagatopyranose.xyz" : -53.11086,
"Alpha-L-lyxopyranose.xyz" : -44.25566,
"Pyrene.xyz" : -50.13186,
"1H-Indole.xyz" : -30.02713,
"Cyclopentane.xyz" : -20.01730,
"Formaldehyde.xyz" : -8.78378,
"Heptacene.xyz" : -93.50124,
"D-Phenylalanine.xyz" : -44.99801,
"Calix-4-arene.xyz" : -111.24596,
"Toluene.xyz" : -24.18084,
"C142.xyz" : -390.40268,
"Kekulene.xyz" : -146.73464,
"Dibutylether.xyz" : -38.08502,
"Alpha-D-glucopyranose.xyz" : -53.12601,
"Furan.xyz" : -18.24163,
"D-Ribose.xyz" : -44.20288,
"Hexacene.xyz" : -81.28197,
"Cucurbit-5-uril.xyz" : -224.62578,
"Cucurbit-4-uril.xyz" : -179.70306,
"Urea.xyz" : -17.56869,
"Porphin.xyz" : -77.08835,
"But-1-ene.xyz" : -15.94565,
"L-Alanine.xyz" : -26.04779,
"Benz-a-anthracene.xyz" : -56.85334,
"Formic_acid.xyz" : -13.65123,
"D-Gulose.xyz" : -53.05604,
"Dipropylether.xyz" : -30.07558,
"C184.xyz" : -505.88632,
"L-Serine.xyz" : -30.89753,
"Isobutyric_acid.xyz" : -25.67606,
"C179.xyz" : -491.71864,
"D-Glutamine.xyz" : -42.00923,
"L-Leucine.xyz" : -38.05780,
"Methanol.xyz" : -10.07491,
"Beta-L-arabinopyranose.xyz" : -44.25398,
"Beta-D-mannopyranose.xyz" : -53.11975,
"Cytosine.xyz" : -30.15666,
"2,2,2-Cryptand.xyz" : -108.45671,
"Alpha-D-tagatopyranose.xyz" : -53.11561,
"Acetone.xyz" : -16.80082,
"D-Fructose.xyz" : -53.05367,
"Tetrahydrofuran.xyz" : -20.82832,
"D-Idose.xyz" : -53.05611,
"Oxamide.xyz" : -25.13101,
"D-Threonine.xyz" : -34.90075,
"Beta-L-xylopyranose.xyz" : -44.26304,
"12-Crown-4.xyz" : -51.30741,
"Ethelene_Glycol.xyz" : -18.93138,
"D-Aspartic_acid.xyz" : -38.48400,
"Di-tert-butylether.xyz" : -38.08153,
"Pyridine.xyz" : -20.53190,
"D-Valine.xyz" : -34.05687,
"N_N-Dimethylacetamide.xyz" : -25.17839,
"D-Altrose.xyz" : -53.05551,
"Beta-D-fucopyranose.xyz" : -48.26187,
"Azulene.xyz" : -32.35002,
"Benzaldehyde.xyz" : -27.74685,
"D-Zylose.xyz" : -44.20204,
"Dimethylether.xyz" : -14.04581,
"Stearic_acid.xyz" : -81.73181,
"L-Arginine.xyz" : -49.91300,
"Glycine.xyz" : -22.04026,
"Adenine.xyz" : -35.49813,
"D-Ribulose.xyz" : -44.20108,
"18-Crown-6.xyz" : -76.96071,
"Propanoic_acid.xyz" : -21.66786,
"Beta-D-lyxopyranose.xyz" : -44.25736,
"Caffeine.xyz" : -52.84270,
"2-Methylpropane.xyz" : -17.24286,
"Methane.xyz" : -5.22995,
"Alpha-D-ribopyranose.xyz" : -44.24677,
"Cucurbit-8-uril.xyz" : -359.38330,
"Alpha-D-arabinopyranose.xyz" : -44.25890,
"Buckminsterfullerene.xyz" : -164.66716,
"C54.xyz" : -147.41057,
"Acetamide.xyz" : -17.18709,
"Guanine.xyz" : -40.37103,
"D-Talose.xyz" : -53.05604,
"Chrysene.xyz" : -56.85796,
"D-Tyrosine.xyz" : -49.85404,
"Hexanoic_acid.xyz" : -33.67946,
"D-Sorbose.xyz" : -53.05604,
"4-Tetrahedral.xyz" : -5.23439,
"Cyclobutane.xyz" : -15.98801,
"Ethyl_carbamate.xyz" : -26.03102,
"Alpha-D-gulopyranose.xyz" : -53.11262,
"L-Valine.xyz" : -34.05850,
"Acenaphthene.xyz" : -39.15854,
"C96H24.xyz" : -278.81454,
"Tetrabenzoporphyrin.xyz" : -127.33483,
"Oxalic_acid.xyz" : -26.07902,
"Beta-D-arabinopyranose.xyz" : -44.25385,
"Circumcoronene.xyz" : -159.57804,
"Fluorene.xyz" : -41.89439,
"Ethylamine.xyz" : -13.61352,
"Acetaldehyde.xyz" : -12.79258,
"Naphthalene.xyz" : -32.40662,
"Ammonia.xyz" : -5.61768,
"Testosterone.xyz" : -75.53527,
"Alpha-D-talopyranose.xyz" : -53.11237,
"D-Asparagine.xyz" : -38.00763,
"L-Asparagine.xyz" : -38.00911,
"C84.xyz" : -230.50285,
"Cycloheptane.xyz" : -28.02904,
"1_3-Oxazole.xyz" : -18.60412,
"D-Glutamic_acid.xyz" : -42.48617,
"Alpha-D-idopyranose.xyz" : -53.12349,
"Beta-D-allopyranose.xyz" : -53.11464,
"Alpha-D-xylopyranose.xyz" : -44.25200,
"Alpha-L-galactopyranose.xyz" : -53.10918,
"Water.xyz" : -6.11167,
"1H-Pyrrole.xyz" : -17.78747,
"D-Allo-threonine.xyz" : -34.90221,
"Norbornane.xyz" : -26.79576,
"D-Alanine.xyz" : -26.04743,
"Anthracene.xyz" : -44.63249,
"Aniline.xyz" : -24.55750,
"Dihydroxyacetone.xyz" : -26.49288,
"Decanoic_acid.xyz" : -49.69628,
"D-Arabinose.xyz" : -44.19917,
"Alpha-L-ribopyranose.xyz" : -44.25351,
"Thymine.xyz" : -34.64189,
"Beta-L-lyxopyranose.xyz" : -44.25741,
"Benzofuran.xyz" : -30.48539,
"D-Tagatose.xyz" : -53.05250,
"Olympicene.xyz" : -59.62263,
"D-Malic_acid.xyz" : -38.95161,
"Coronene.xyz" : -73.37018,
"L-Lactic_acid.xyz" : -26.51297,
"Isopropanol.xyz" : -18.08972,
"D-Threose.xyz" : -35.34824,
"L-Aspartic_acid.xyz" : -38.48183,
"Cucurbit-6-uril.xyz" : -269.54571,
"Cucurbit-7-uril.xyz" : -314.46422,
"D-Isoleucine.xyz" : -38.05581,
"Acetic_acid.xyz" : -17.66125,
"L-Glutamine.xyz" : -42.01152,
"Butanone.xyz" : -20.80510,
"L-Isoleucine.xyz" : -38.05953,
"D-Leucine.xyz" : -38.05757,
"Annulene.xyz" : -60.49287,
"L-Lysine.xyz" : -42.44211,
"L-Threonine.xyz" : -34.89944,
"Beta-D-rhamnopyranose.xyz" : -48.25654,
"L-Malic_acid.xyz" : -38.95158,
"D-Glucose.xyz" : -53.05819,
"Anisole.xyz" : -29.00255,
"D-Histidine.xyz" : -42.97723,
"Methylamine.xyz" : -9.60808,
"L-Tryptophan.xyz" : -54.85154,
"Alpha-D-rhamnopyranose.xyz" : -48.27079,
"Adamantane.xyz" : -37.57708,
"Beta-D-glucopyranose.xyz" : -53.12303,
"Pleaidene.xyz" : -56.83913,
"Propan-1-ol.xyz" : -18.08872,
"Linoleic_acid.xyz" : -79.13437,
"7-Circulene.xyz" : -85.55329,
"D-Allose.xyz" : -53.06317,
"Beta-D-idopyranose.xyz" : -53.10864,
"L-Glutamic_acid.xyz" : -42.48744,
"Acetylene.xyz" : -6.62791,
"Estradiol.xyz" : -74.26040,
"Cholesterol.xyz" : -108.00476,
"D-Proline.xyz" : -32.81375,
"C71.xyz" : -194.43918,
"D-Tryptophan.xyz" : -54.85184,
"Propane.xyz" : -13.23759,
"Tetracene.xyz" : -56.84325,
"Ethylmethylether.xyz" : -18.05483,
"D-Lactic_acid.xyz" : -26.51531,
"Cyclohexane.xyz" : -24.02615,
"Alpha-D-mannopyranose.xyz" : -53.12395,
"Alpha-L-xylopyranose.xyz" : -44.25128,
"Palmitic_acid.xyz" : -73.72142,
"Butanoic_acid.xyz" : -25.67294,
"Lauric_acid.xyz" : -57.70464,
"D-Mannose.xyz" : -53.05106,
"Benzo-c-phenanthrene.xyz" : -56.85585,
"Phenalene.xyz" : -41.90176,
"Diisopropylether.xyz" : -30.07568,
"D-Lysine.xyz" : -42.44077,
"C175.xyz" : -481.07628,
"Alpha-L-sorbopyranose.xyz" : -53.11367,
"L-Ascorbic_acid.xyz" : -50.52512,
"Alpha-D-fucopyranose.xyz" : -48.25834,
"15-Crown-5.xyz" : -64.14145,
"1_2-Oxazole.xyz" : -18.57682,
"Alpha-D-lyxopyranose.xyz" : -44.25573,
"L-Tyrosine.xyz" : -49.85316,
"L-Phenylalanine.xyz" : -45.00174,
"C150H30.xyz" : -431.55531,
"Beta-D-ribopyranose.xyz" : -44.25535,
"Pentacene.xyz" : -69.06267,
"D-Tartaric_acid.xyz" : -43.80091,
"D-Erythrose.xyz" : -35.34522,
"Cyclopropane.xyz" : -11.94136,
"Nitrobenzene.xyz" : -32.80414,
"D-Arginine.xyz" : -49.91295,
"Ovalene.xyz" : -96.60058,
"Ethene.xyz" : -7.93611,
"Alpha-D-galactopyranose.xyz" : -53.10897,
"L-4-Nitrophenylalanine.xyz" : -57.63248,
"D-Lyxose.xyz" : -44.20331,
"1H-Pyrazole.xyz" : -18.11492,
"Diethylether.xyz" : -22.06404,
"N_N-Dimethylformamide.xyz" : -21.17030,
"Oleic_acid.xyz" : -80.43411,
"Azepane.xyz" : -28.38825,
"Ethane.xyz" : -9.23335,
"Beta-D-galactopyranose.xyz" : -53.11951,
"Beta-D-gulopyranose.xyz" : -53.11733,
"Propyne.xyz" : -10.63863,
"Alpha-L-rhamnopyranose.xyz" : -48.27071,
"Cubane.xyz" : -26.95393,
"Ethanol.xyz" : -14.08334,
"Octanoic_acid.xyz" : -41.68788,
"Uracil.xyz" : -30.63690,
"Glycerol.xyz" : -27.78708,
"Phenanthrene.xyz" : -44.63119,
"C10.xyz" : -27.03006,
"Beta-D-talopyranose.xyz" : -53.10937,
"Benzoic_acid.xyz" : -32.61358,
"Alpha-D-allopyranose.xyz" : -53.11433,
"L-Allo-isoleucine.xyz" : -38.05737,
"Beta-D-xylopyranose.xyz" : -44.26299,
"Beta-D-fructopyranose.xyz" : -53.11724,
"C165.xyz" : -454.09309}

from uebung1_Johannes.extended_hueckel_theory import EHT as EHT_Jo
from uebung1_Johannes.extended_hueckel_theory import Molecule as Mol_Jo
def moleculeCalculatorJohannes(xyz_file):
    mol = Mol_Jo()
    mol.read_from_xyz(xyz_file)
    eht = EHT_Jo(mol, 'uebung1_Johannes/vsto-3g', 'uebung1_Johannes/eth-params')
    return eht.getEnergy()

import uebung1_Robin.overlap_calculator.molecule as mo_r
import uebung1_Robin.overlap_calculator.basis_set as bs_r
def moleculeCalculatorRobin(xyz_file):
    mol = mo_r.from_xyz(xyz_file, 'uebung1_Robin/overlap_calculator/vsto-3g')
    mol.eht_hamiltonian()
    mol.solve_eht()
    mol.eht_total_energy()
    mol.klopman_repulsion_energies()
    return mol.get_total_energy_klopman_eht()

path_to_test_molecules = '/Users/johannes/Documents/Uni/Programmierpraktikum/uebungen/tcprog-py/test_molecules'

structures = atom_energy_dict.keys()
num_structures = len(structures)
johannes_times = []
robin_times = []

sys.stdout.write(f'Calculating {0}/{num_structures}')
sys.stdout.flush()
for i, structure in enumerate(structures):
    start = time.perf_counter()
    eRobin = moleculeCalculatorRobin(os.path.join(path_to_test_molecules,structure))
    robin_times.append(time.perf_counter() - start)
    start = time.perf_counter()
    eJohannes = moleculeCalculatorJohannes(os.path.join(path_to_test_molecules,structure))
    johannes_times.append(time.perf_counter() - start)
    sys.stdout.write(f'\rCalculating {i+1}/{num_structures}')
    sys.stdout.flush()

np_johannes = np.array(johannes_times)
np_robin = np.array(robin_times)
print('Johannes:',np.sum(np_johannes))
print('Robin:',np.sum(np_robin))
np.save("johannes1",np_johannes)
np.save("robin1",np_robin)